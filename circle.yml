machine:
  environment:
    GOPATH: "$HOME/gocode"
    ROOTPATH: "$HOME/gocode/src/bitbucket.org/zurichess/zurichess"

checkout:
  post:
    - rm -rf $GOPATH/src
    - mkdir -p $GOPATH/src/bitbucket.org/zurichess
    - ln -s $HOME/$CIRCLE_PROJECT_REPONAME $ROOTPATH

compile:   
  override:
    - cd $ROOTPATH && go build -v ./...
    - cd $ROOTPATH && go install -v ./zurichess

test:
  pre:
    - cd $ROOTPATH && go vet ./...
  override:
    - cd $ROOTPATH && go test -v -race ./...

general:
  artifacts:
    - "$ROOTPATH/bin/zurichess"
